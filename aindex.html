<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>نظام إدارة درجات الطلاب المتكامل</title>
    <script src="https://unpkg.com/xlsx/dist/xlsx.full.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #3498db;
            --secondary: #2c3e50;
            --success: #2ecc71;
            --danger: #e74c3c;
            --warning: #f39c12;
            --light: #f8f9fa;
            --dark: #343a40;
            --midterm: #e8f4fd;
            --final: #d5e8ff;
            --total: #d4edda;
            --excellent: #28a745;
            --very-good: #17a2b8;
            --good: #ffc107;
            --pass: #fd7e14;
            --fail: #dc3545;
        }
        
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f5f7fa;
            color: #333;
            line-height: 1.6;
            padding: 0;
            direction: rtl;
        }
        
        .container {
            width: 98%;
            max-width: 1800px;
            margin: 0 auto;
            padding: 10px 5px;
        }
        
        header {
            background: linear-gradient(135deg, var(--secondary), var(--primary));
            color: white;
            padding: 10px 0;
            text-align: center;
            border-bottom: 5px solid var(--primary);
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            position: relative;
        }
        
        header h1 {
            font-size: 1.3rem;
            margin-bottom: 5px;
        }
        
        .app-description {
            max-width: 800px;
            margin: 0 auto;
            font-size: 0.8rem;
            opacity: 0.9;
        }
        
        .tabs {
            display: flex;
            margin: 8px 0;
            background: white;
            border-radius: 5px;
            overflow: hidden;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        .tab {
            flex: 1;
            padding: 8px;
            text-align: center;
            cursor: pointer;
            background: #e9ecef;
            transition: all 0.3s;
            font-weight: bold;
            font-size: 0.8rem;
        }
        
        .tab.active {
            background: var(--primary);
            color: white;
        }
        
        .tab:hover:not(.active) {
            background: #d1d7dc;
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .main-content {
            display: grid;
            grid-template-columns: 200px 1fr;
            gap: 10px;
            margin-top: 8px;
        }
        
        .sidebar {
            background: white;
            border-radius: 6px;
            padding: 10px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
            height: fit-content;
            font-size: 0.85rem;
        }
        
        .content {
            background: white;
            border-radius: 6px;
            padding: 10px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
            overflow-x: auto;
            min-height: 500px;
        }
        
        .section-title {
            color: var(--secondary);
            border-bottom: 2px solid var(--primary);
            padding-bottom: 6px;
            margin-bottom: 10px;
            font-size: 1rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .section-title .controls {
            display: flex;
            gap: 6px;
        }
        
        .form-group {
            margin-bottom: 12px;
        }
        
        label {
            display: block;
            margin-bottom: 4px;
            font-weight: 600;
            color: var(--secondary);
            font-size: 0.8rem;
        }
        
        input, select, textarea {
            width: 100%;
            padding: 6px;
            border: 1px solid #ddd;
            border-radius: 3px;
            font-size: 0.8rem;
            transition: border 0.3s;
            text-align: right;
        }
        
        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 2px rgba(52, 152, 219, 0.2);
        }
        
        button {
            background-color: var(--primary);
            color: white;
            border: none;
            padding: 6px 10px;
            border-radius: 3px;
            cursor: pointer;
            font-size: 0.8rem;
            font-weight: 600;
            transition: background 0.3s;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 4px;
        }
        
        button:hover {
            background-color: #2980b9;
        }
        
        .btn-success {
            background-color: var(--success);
        }
        
        .btn-success:hover {
            background-color: #27ae60;
        }
        
        .btn-danger {
            background-color: var(--danger);
        }
        
        .btn-danger:hover {
            background-color: #c0392b;
        }
        
        .btn-warning {
            background-color: var(--warning);
        }
        
        .btn-warning:hover {
            background-color: #e67e22;
        }
        
        .table-container {
            overflow-x: auto;
            margin-top: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            padding: 5px;
            max-height: 75vh;
            overflow-y: auto;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            min-width: 800px;
            text-align: right;
        }
        
        th, td {
            padding: 8px;
            text-align: center;
            border: 1px solid #ddd;
            font-size: 0.85rem;
        }
        
        th {
            background-color: var(--secondary);
            color: white;
            font-weight: 600;
            position: sticky;
            top: 0;
        }
        
        tr:nth-child(even) {
            background-color: #f9f9f9;
        }
        
        tr:hover {
            background-color: #f1f7ff;
        }
        
        .midterm-cell {
            background-color: var(--midterm);
            width: 50px !important;
            min-width: 50px !important;
        }
        
        .final-cell {
            background-color: var(--final);
            width: 50px !important;
            min-width: 50px !important;
        }
        
        .total-cell {
            background-color: var(--total);
            font-weight: bold;
            width: 60px !important;
            min-width: 60px !important;
        }
        
        .subject-header {
            background-color: #2c3e50;
            color: white;
        }
        
        .teacher-view {
            background-color: #fef9e7;
            padding: 10px;
            border-radius: 5px;
            margin-top: 10px;
            display: none;
            font-size: 0.85rem;
        }
        
        .alert {
            padding: 8px;
            border-radius: 3px;
            margin: 8px 0;
            display: none;
            font-size: 0.8rem;
        }
        
        .alert-danger {
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        
        .alert-success {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        
        .teacher-controls {
            display: flex;
            gap: 6px;
            margin-top: 8px;
        }
        
        .teacher-controls button {
            width: auto;
            padding: 5px 8px;
        }
        
        .action-buttons {
            display: flex;
            gap: 6px;
            margin-top: 10px;
            flex-wrap: wrap;
        }
        
        .back-btn {
            position: absolute;
            left: 10px;
            top: 10px;
            background: rgba(255,255,255,0.2);
            padding: 5px 8px;
            border-radius: 3px;
            color: white;
            text-decoration: none;
            display: flex;
            align-items: center;
            gap: 3px;
            font-size: 0.8rem;
        }
        
        .back-btn:hover {
            background: rgba(255,255,255,0.3);
        }
        
        .subject-group {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 3px;
        }
        
        .subject-group-header {
            grid-column: span 3;
            background: var(--secondary);
            color: white;
            padding: 5px;
            border-radius: 3px;
            margin-bottom: 3px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 0.8rem;
        }
        
        .report-controls {
            display: flex;
            justify-content: flex-end;
            gap: 6px;
            margin-top: 10px;
        }
        
        .student-id {
            font-size: 0.7em;
            color: #666;
        }
        
        .grade-input {
            width: 50px;
            padding: 5px;
            text-align: center;
            border: 2px solid #ccc;
            border-radius: 3px;
            font-size: 0.85rem;
            background-color: white;
        }
        
        .grade-input:focus {
            border-color: var(--primary);
            outline: none;
            box-shadow: 0 0 0 2px rgba(52, 152, 219, 0.2);
        }
        
        .total-display {
            background-color: #d4edda;
            border: 2px solid #c3e6cb;
            border-radius: 3px;
            padding: 5px;
            font-weight: bold;
            width: 60px;
            text-align: center;
            font-size: 0.85rem;
        }
        
        .grade-header {
            min-width: 50px;
        }
        
        .grade-header.small {
            min-width: 50px;
        }
        
        .class-info {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 8px;
            margin-bottom: 8px;
            background: #f8f9fa;
            padding: 6px;
            border-radius: 4px;
            font-size: 0.8rem;
        }
        
        .class-info p {
            margin: 0;
        }
        
        .excellent-grade {
            background-color: var(--excellent);
            color: white;
        }
        
        .very-good-grade {
            background-color: var(--very-good);
            color: white;
        }
        
        .good-grade {
            background-color: var(--good);
        }
        
        .pass-grade {
            background-color: var(--pass);
            color: white;
        }
        
        .fail-grade {
            background-color: var(--fail);
            color: white;
        }
        
        #multipleStudentsModal {
            display: none;
            margin-top: 15px;
            background: #f8f9fa;
            padding: 10px;
            border-radius: 5px;
            border: 1px solid #ddd;
        }
        
        #studentsList {
            min-height: 150px;
            direction: rtl;
            text-align: right;
        }
        
        #multipleStudentsModal .action-buttons {
            margin-top: 10px;
            justify-content: center;
        }
        
        @media (max-width: 1200px) {
            .main-content {
                grid-template-columns: 180px 1fr;
            }
        }
        
        @media (max-width: 992px) {
            .main-content {
                grid-template-columns: 1fr;
            }
            
            .sidebar {
                order: 2;
            }
            
            header h1 {
                font-size: 1.2rem;
                padding: 0 10px;
            }
            
            .action-buttons {
                flex-direction: row;
            }
            
            .action-buttons button {
                width: auto;
                flex: 1;
            }
            
            .class-info {
                grid-template-columns: repeat(2, 1fr);
            }
        }
        
        @media (max-width: 768px) {
            .class-info {
                grid-template-columns: 1fr;
            }
            
            .action-buttons button {
                width: 100%;
            }
        }
        
        .compact-view .class-info {
            display: none;
        }
        
        .compact-view .section-title .controls {
            display: none;
        }
        
        .compact-view .sidebar {
            display: none;
        }
        
        .compact-view .main-content {
            grid-template-columns: 1fr;
        }
        
        .compact-view .table-container {
            max-height: 85vh;
        }
        
        .view-toggle {
            position: absolute;
            right: 10px;
            top: 10px;
            background: rgba(255,255,255,0.2);
            padding: 5px 8px;
            border-radius: 3px;
            color: white;
            text-decoration: none;
            display: flex;
            align-items: center;
            gap: 3px;
            font-size: 0.8rem;
            cursor: pointer;
            border: none;
        }
        
        .student-name-cell {
            min-width: 150px;
            font-weight: 600;
        }
        
        .subject-grade-header {
            font-size: 0.9rem;
            font-weight: bold;
        }
        
        .average-cell {
            font-weight: bold;
            color: var(--secondary);
        }
        
        .delete-btn {
            background-color: transparent;
            color: var(--danger);
            padding: 2px;
            font-size: 0.8rem;
        }
        
        .delete-btn:hover {
            background-color: #f8d7da;
        }
        
        .subject-name-header {
            background-color: #3a506b;
            color: white;
            font-weight: bold;
        }
        
        .symbol-header {
            background-color: #2c3e50;
            color: white;
        }
        
        .symbol-cell {
            font-weight: bold;
            font-size: 0.9rem;
        }
    </style>
</head>
<body>
    <header>
        <a href="#" class="back-btn">
            <span>←</span> العودة
        </a>
        <button class="view-toggle" id="viewToggle">
            <i class="fas fa-compress"></i> وضع التركيز
        </button>
        <div class="container">
            <h1>نظام إدارة درجات الطلاب المتكامل</h1>
            <p class="app-description">واجهة مخصصة لإدخال درجات الطلاب مع تركيز على جدول الدرجات</p>
        </div>
    </header>

    <div class="container">
        <div class="tabs">
            <div class="tab active" data-tab="entry">إدخال الدرجات</div>
            <div class="tab" data-tab="report">كشف الدرجات</div>
        </div>
        
        <div class="alert alert-danger" id="errorAlert"></div>
        <div class="alert alert-success" id="successAlert"></div>
        
        <!-- واجهة إدخال الدرجات -->
        <div class="tab-content active" id="entryTab">
            <div class="main-content">
                <div class="sidebar">
                    <h2 class="section-title">إدارة البيانات</h2>
                    
                    <div class="form-group">
                        <label for="gradeLevel">الصف الدراسي</label>
                        <select id="gradeLevel">
                            <option value="">اختر الصف الدراسي</option>
                            <option value="الأول">الصف الأول</option>
                            <option value="الثاني">الصف الثاني</option>
                            <option value="الثالث">الصف الثالث</option>
                            <option value="الرابع">الصف الرابع</option>
                            <option value="الخامس">الصف الخامس</option>
                            <option value="السادس">الصف السادس</option>
                            <option value="السابع">الصف السابع</option>
                            <option value="الثامن">الصف الثامن</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="className">اسم الفصل</label>
                        <input type="text" id="className" placeholder="أدخل اسم الفصل">
                    </div>
                    
                    <div class="form-group">
                        <label for="studentName">اسم الطالب</label>
                        <input type="text" id="studentName" placeholder="أدخل اسم الطالب">
                        <button class="btn-success" id="addStudentBtn" style="margin-top: 6px; width:100%;">
                            <i class="fas fa-user-plus"></i> إضافة طالب
                        </button>
                    </div>
                    
                    <div class="form-group">
                        <button class="btn-success" id="addMultipleStudentsBtn" style="width:100%;">
                            <i class="fas fa-users"></i> إضافة عدة طلاب
                        </button>
                    </div>
                    
                    <div id="multipleStudentsModal">
                        <label for="studentsList">أدخل أسماء الطلاب (كل اسم في سطر):</label>
                        <textarea id="studentsList" rows="5" placeholder="أحمد محمد
فاطمة عبدالله
خالد حسن
..."></textarea>
                        <div class="action-buttons">
                            <button class="btn-success" id="saveStudentsBtn"><i class="fas fa-save"></i> إضافة الطلاب</button>
                            <button class="btn-danger" id="cancelStudentsBtn"><i class="fas fa-times"></i> إلغاء</button>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="subjectName">اسم المادة</label>
                        <input type="text" id="subjectName" placeholder="أدخل اسم المادة">
                        <button class="btn-success" id="addSubjectBtn" style="margin-top: 6px; width:100%;">
                            <i class="fas fa-book"></i> إضافة مادة
                        </button>
                    </div>
                    
                    <div class="teacher-view" id="teacherView">
                        <h3 style="font-size: 0.9rem;">واجهة المعلم</h3>
                        <p id="teacherSubject" style="margin-bottom: 5px;">المادة: الرياضيات</p>
                        <div class="teacher-controls">
                            <button id="saveGradesBtn"><i class="fas fa-save"></i> حفظ</button>
                            <button class="btn-danger" id="cancelEditBtn"><i class="fas fa-times"></i> إلغاء</button>
                        </div>
                    </div>
                </div>
                
                <div class="content">
                    <h2 class="section-title">
                        جدول الدرجات
                        <div class="controls">
                            <button class="btn-warning" id="calculateBtn"><i class="fas fa-calculator"></i> حساب المعدلات</button>
                            <button class="btn-success" id="saveAllBtn"><i class="fas fa-save"></i> حفظ الكل</button>
                        </div>
                    </h2>
                    <div class="class-info">
                        <p><strong>الصف:</strong> <span id="currentGrade">-</span></p>
                        <p><strong>الفصل:</strong> <span id="currentClass">-</span></p>
                        <p><strong>عدد الطلاب:</strong> <span id="studentCount">٠</span></p>
                        <p><strong>عدد المواد:</strong> <span id="subjectCount">٠</span></p>
                    </div>
                    
                    <div class="table-container">
                        <table id="gradesTable">
                            <thead>
                                <tr id="gradesTableHeader">
                                    <th style="width: 40px;">م</th>
                                    <th class="student-name-cell">اسم الطالب</th>
                                    <!-- سيتم إضافة عناوين المواد ديناميكياً -->
                                    <th class="average-cell">المعدل</th>
                                    <th style="width: 50px;">حذف</th>
                                </tr>
                                <tr id="gradesTableSubHeader">
                                    <th></th>
                                    <th></th>
                                    <!-- سيتم إضافة عناوين فرعية للمواد ديناميكياً -->
                                    <th></th>
                                    <th></th>
                                </tr>
                            </thead>
                            <tbody id="gradesTableBody">
                                <!-- سيتم إضافة صفوف الطلاب ديناميكياً -->
                            </tbody>
                        </table>
                    </div>
                    
                    <div class="action-buttons">
                        <button class="btn-success" id="autoFillBtn"><i class="fas fa-magic"></i> تعبئة تلقائية</button>
                        <button class="btn-warning" id="resetBtn"><i class="fas fa-redo"></i> إعادة تعيين</button>
                        <button class="btn-danger" id="clearDataBtn"><i class="fas fa-trash"></i> مسح البيانات</button>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- واجهة كشف الدرجات -->
        <div class="tab-content" id="reportTab">
            <div class="content">
                <h2 class="section-title">
                    كشف الدرجات النهائي
                    <div class="controls">
                        <button class="btn-success" id="copyBtn"><i class="fas fa-copy"></i> نسخ</button>
                        <button class="btn-success" id="excelBtn"><i class="fas fa-file-excel"></i> إكسل</button>
                        <button class="btn-warning" id="printBtn"><i class="fas fa-print"></i> طباعة</button>
                    </div>
                </h2>
                
                <div class="class-info">
                    <p><strong>الصف:</strong> <span id="reportGrade">-</span></p>
                    <p><strong>الفصل:</strong> <span id="reportClass">-</span></p>
                    <p><strong>عدد الطلاب:</strong> <span id="reportStudentCount">٠</span></p>
                    <p><strong>عدد المواد:</strong> <span id="reportSubjectCount">٠</span></p>
                </div>
                
                <div class="table-container">
                    <table id="reportTable">
                        <thead>
                            <tr id="reportTableHeader">
                                <th style="width: 40px;">م</th>
                                <th class="student-name-cell">اسم الطالب</th>
                                <!-- سيتم إضافة عناوين المواد ديناميكياً -->
                                <th class="average-cell">المعدل</th>
                                <th style="width: 80px;">التقدير</th>
                            </tr>
                            <tr id="reportTableSubHeader">
                                <th></th>
                                <th></th>
                                <!-- سيتم إضافة عناوين فرعية للمواد ديناميكياً -->
                                <th></th>
                                <th></th>
                            </tr>
                        </thead>
                        <tbody id="reportTableBody">
                            <!-- سيتم إضافة صفوف الطلاب ديناميكياً -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <script>
        // دالة لتحويل الأرقام إلى الأرقام العربية الهندية
        function toArabicNumerals(number) {
            if (number === undefined || number === null || number === '') return '';
            const arabicNumerals = ['٠', '١', '٢', '٣', '٤', '٥', '٦', '٧', '٨', '٩'];
            return number.toString().replace(/\d/g, digit => arabicNumerals[digit]);
        }

        // دالة لتحويل الأرقام في سلسلة نصية إلى الأرقام الهندية
        function convertNumbersInString(str) {
            const arabicNumerals = ['٠', '١', '٢', '٣', '٤', '٥', '٦', '٧', '٨', '٩'];
            return str.replace(/\d/g, digit => arabicNumerals[digit]);
        }

        // بنية البيانات
        let classData = {
            gradeLevel: '',
            className: '',
            students: [],
            subjects: [],
            grades: {} // {studentName: {subject: {midterm, final, total}}}
        };

        // عناصر DOM
        const gradeLevelSelect = document.getElementById('gradeLevel');
        const classNameInput = document.getElementById('className');
        const studentNameInput = document.getElementById('studentName');
        const subjectNameInput = document.getElementById('subjectName');
        const addStudentBtn = document.getElementById('addStudentBtn');
        const addSubjectBtn = document.getElementById('addSubjectBtn');
        const gradesTable = document.getElementById('gradesTable');
        const gradesTableHeader = document.getElementById('gradesTableHeader');
        const gradesTableSubHeader = document.getElementById('gradesTableSubHeader');
        const gradesTableBody = document.getElementById('gradesTableBody');
        const reportTable = document.getElementById('reportTable');
        const reportTableHeader = document.getElementById('reportTableHeader');
        const reportTableSubHeader = document.getElementById('reportTableSubHeader');
        const reportTableBody = document.getElementById('reportTableBody');
        const currentGradeSpan = document.getElementById('currentGrade');
        const reportGradeSpan = document.getElementById('reportGrade');
        const currentClassSpan = document.getElementById('currentClass');
        const reportClassSpan = document.getElementById('reportClass');
        const studentCountSpan = document.getElementById('studentCount');
        const subjectCountSpan = document.getElementById('subjectCount');
        const reportStudentCountSpan = document.getElementById('reportStudentCount');
        const reportSubjectCountSpan = document.getElementById('reportSubjectCount');
        const teacherView = document.getElementById('teacherView');
        const teacherSubject = document.getElementById('teacherSubject');
        const saveGradesBtn = document.getElementById('saveGradesBtn');
        const saveAllBtn = document.getElementById('saveAllBtn');
        const cancelEditBtn = document.getElementById('cancelEditBtn');
        const calculateBtn = document.getElementById('calculateBtn');
        const resetBtn = document.getElementById('resetBtn');
        const clearDataBtn = document.getElementById('clearDataBtn');
        const autoFillBtn = document.getElementById('autoFillBtn');
        const copyBtn = document.getElementById('copyBtn');
        const excelBtn = document.getElementById('excelBtn');
        const printBtn = document.getElementById('printBtn');
        const errorAlert = document.getElementById('errorAlert');
        const successAlert = document.getElementById('successAlert');
        const tabs = document.querySelectorAll('.tab');
        const tabContents = document.querySelectorAll('.tab-content');
        const viewToggle = document.getElementById('viewToggle');
        const addMultipleStudentsBtn = document.getElementById('addMultipleStudentsBtn');
        const multipleStudentsModal = document.getElementById('multipleStudentsModal');
        const studentsListTextarea = document.getElementById('studentsList');
        const saveStudentsBtn = document.getElementById('saveStudentsBtn');
        const cancelStudentsBtn = document.getElementById('cancelStudentsBtn');
        
        // تهيئة التطبيق عند التحميل
        document.addEventListener('DOMContentLoaded', function() {
            loadData();
            updateUI();
            
            // إضافة مستمعات الأحداث
            addEventListeners();
        });

        // إضافة مستمعات الأحداث
        function addEventListeners() {
            // وضع التركيز على الجدول
            viewToggle.addEventListener('click', toggleCompactView);
            
            // إدارة التبويبات
            tabs.forEach(tab => {
                tab.addEventListener('click', () => {
                    tabs.forEach(t => t.classList.remove('active'));
                    tabContents.forEach(c => c.classList.remove('active'));
                    
                    tab.classList.add('active');
                    document.getElementById(`${tab.dataset.tab}Tab`).classList.add('active');
                    
                    if (tab.dataset.tab === 'report') {
                        updateReportTable();
                    }
                });
            });
            
            // تحديث الصف الدراسي
            gradeLevelSelect.addEventListener('change', function() {
                if (this.value !== '') {
                    classData.gradeLevel = this.value;
                    currentGradeSpan.textContent = this.value;
                    reportGradeSpan.textContent = this.value;
                    saveData();
                }
            });
            
            // تحديث اسم الفصل
            classNameInput.addEventListener('blur', function() {
                const className = this.value.trim();
                if (className !== '') {
                    classData.className = className;
                    currentClassSpan.textContent = className;
                    reportClassSpan.textContent = className;
                    saveData();
                }
            });
            
            // إضافة طالب
            addStudentBtn.addEventListener('click', function() {
                const studentName = studentNameInput.value.trim();
                if (addStudent(studentName)) {
                    studentNameInput.value = '';
                    updateGradesTable();
                    showSuccess('تم إضافة الطالب بنجاح');
                }
            });
            
            // إضافة مادة
            addSubjectBtn.addEventListener('click', function() {
                const subjectName = subjectNameInput.value.trim();
                if (addSubject(subjectName)) {
                    subjectNameInput.value = '';
                    updateGradesTable();
                    showSuccess('تم إضافة المادة بنجاح');
                }
            });
            
            // حفظ جميع الدرجات
            saveAllBtn.addEventListener('click', function() {
                saveAllGrades();
                showSuccess('تم حفظ جميع الدرجات بنجاح');
            });
            
            // حساب المعدلات
            calculateBtn.addEventListener('click', function() {
                calculateAverages();
                showSuccess('تم حساب المعدلات بنجاح');
            });
            
            // تعبئة الدرجات تلقائياً
            autoFillBtn.addEventListener('click', function() {
                autoFillGrades();
                showSuccess('تم تعبئة الدرجات تلقائياً بنجاح');
            });
            
            // إعادة تعيين الحقول
            resetBtn.addEventListener('click', resetFields);
            
            // مسح جميع البيانات
            clearDataBtn.addEventListener('click', clearAllData);
            
            // نسخ كشف الدرجات
            copyBtn.addEventListener('click', copyReportToClipboard);
            
            // تصدير إلى إكسل
            excelBtn.addEventListener('click', exportToExcel);
            
            // طباعة الكشف
            printBtn.addEventListener('click', function() {
                window.print();
            });
            
            // فتح نافذة إضافة عدة طلاب
            addMultipleStudentsBtn.addEventListener('click', function() {
                multipleStudentsModal.style.display = 'block';
                studentsListTextarea.focus();
            });
            
            // إلغاء إضافة عدة طلاب
            cancelStudentsBtn.addEventListener('click', function() {
                multipleStudentsModal.style.display = 'none';
                studentsListTextarea.value = '';
            });
            
            // حفظ الطلاب المتعددين
            saveStudentsBtn.addEventListener('click', function() {
                const namesText = studentsListTextarea.value.trim();
                if (!namesText) {
                    showError('الرجاء إدخال أسماء الطلاب');
                    return;
                }
                
                const namesArray = namesText.split('\n')
                    .map(name => name.trim())
                    .filter(name => name !== '');
                
                if (namesArray.length === 0) {
                    showError('لم يتم إدخال أسماء صالحة');
                    return;
                }
                
                addMultipleStudents(namesArray);
                multipleStudentsModal.style.display = 'none';
                studentsListTextarea.value = '';
            });
        }

        // إضافة عدة طلاب دفعة واحدة
        function addMultipleStudents(names) {
            let addedCount = 0;
            let duplicateCount = 0;
            
            names.forEach(name => {
                if (!name) return;
                
                if (classData.students.includes(name)) {
                    duplicateCount++;
                    return;
                }
                
                classData.students.push(name);
                classData.grades[name] = {};
                addedCount++;
            });
            
            // ترتيب الطلاب أبجدياً
            classData.students.sort();
            
            updateStudentCount();
            updateGradesTable();
            updateReportTable();
            saveData();
            
            showSuccess(`تم إضافة ${toArabicNumerals(addedCount)} طالب بنجاح. ${duplicateCount ? ` (تم تجاهل ${toArabicNumerals(duplicateCount)} أسماء مكررة)` : ''}`);
        }

        // تبديل وضع التركيز
        function toggleCompactView() {
            document.body.classList.toggle('compact-view');
            const icon = viewToggle.querySelector('i');
            if (document.body.classList.contains('compact-view')) {
                icon.className = 'fas fa-expand';
                viewToggle.innerHTML = '<i class="fas fa-expand"></i> عرض كامل';
            } else {
                icon.className = 'fas fa-compress';
                viewToggle.innerHTML = '<i class="fas fa-compress"></i> وضع التركيز';
            }
        }

        // إضافة طالب مع التحقق
        function addStudent(name) {
            if (!name.trim()) {
                showError('الرجاء إدخال اسم الطالب');
                return false;
            }
            
            if (classData.students.includes(name)) {
                showError('اسم الطالب موجود مسبقاً');
                return false;
            }
            
            classData.students.push(name);
            classData.grades[name] = {};
            updateStudentCount();
            saveData();
            return true;
        }

        // إضافة مادة مع التحقق
        function addSubject(name) {
            if (!name.trim()) {
                showError('الرجاء إدخال اسم المادة');
                return false;
            }
            
            if (classData.subjects.includes(name)) {
                showError('اسم المادة موجود مسبقاً');
                return false;
            }
            
            classData.subjects.push(name);
            updateSubjectCount();
            saveData();
            return true;
        }

        // تحديث جدول الدرجات
        function updateGradesTable() {
            // مسح الجدول الحالي
            while (gradesTableHeader.children.length > 4) {
                gradesTableHeader.removeChild(gradesTableHeader.lastChild);
            }
            while (gradesTableSubHeader.children.length > 4) {
                gradesTableSubHeader.removeChild(gradesTableSubHeader.lastChild);
            }
            gradesTableBody.innerHTML = '';
            
            // إضافة عناوين المواد
            classData.subjects.forEach(subject => {
                // عنوان المادة الرئيسي
                const subjectHeader = document.createElement('th');
                subjectHeader.colSpan = 3;
                subjectHeader.className = 'subject-name-header';
                subjectHeader.setAttribute('data-subject', subject);
                subjectHeader.innerHTML = subject;
                gradesTableHeader.insertBefore(subjectHeader, gradesTableHeader.querySelector('.average-cell'));
                
                // العناوين الفرعية للمادة
                const midtermHeader = document.createElement('th');
                midtermHeader.className = 'symbol-header';
                midtermHeader.textContent = 'ن';
                gradesTableSubHeader.insertBefore(midtermHeader, gradesTableSubHeader.querySelector('th:nth-child(3)'));
                
                const finalHeader = document.createElement('th');
                finalHeader.className = 'symbol-header';
                finalHeader.textContent = 'م';
                gradesTableSubHeader.insertBefore(finalHeader, gradesTableSubHeader.querySelector('th:nth-child(3)'));
                
                const totalHeader = document.createElement('th');
                totalHeader.className = 'symbol-header';
                totalHeader.textContent = 'مج';
                gradesTableSubHeader.insertBefore(totalHeader, gradesTableSubHeader.querySelector('th:nth-child(3)'));
            });
            
            // إضافة صفوف الطلاب
            classData.students.forEach((student, index) => {
                const row = document.createElement('tr');
                row.className = 'grades-table-row';
                row.innerHTML = `
                    <td>${toArabicNumerals(index + 1)}</td>
                    <td class="student-name-cell">${student}</td>
                    <!-- سيتم إضافة خلايا المواد ديناميكياً -->
                    <td class="total-cell average-cell">${toArabicNumerals(0.00)}</td>
                    <td><button class="delete-btn" data-student="${student}"><i class="fas fa-trash"></i></button></td>
                `;
                
                // إضافة خلايا الدرجات لكل مادة
                classData.subjects.forEach(subject => {
                    const grades = classData.grades[student]?.[subject] || {};
                    
                    const midtermCell = document.createElement('td');
                    midtermCell.className = 'midterm-cell';
                    midtermCell.innerHTML = `
                        <input type="number" min="0" max="50" class="grade-input midterm" 
                            data-student="${student}" data-subject="${subject}" 
                            value="${grades.midterm || ''}" placeholder="ن" title="الدرجة النصفية">
                    `;
                    row.insertBefore(midtermCell, row.querySelector('.average-cell'));
                    
                    const finalCell = document.createElement('td');
                    finalCell.className = 'final-cell';
                    finalCell.innerHTML = `
                        <input type="number" min="0" max="50" class="grade-input final" 
                            data-student="${student}" data-subject="${subject}" 
                            value="${grades.final || ''}" placeholder="م" title="الدرجة النهائية">
                    `;
                    row.insertBefore(finalCell, row.querySelector('.average-cell'));
                    
                    const totalCell = document.createElement('td');
                    totalCell.className = 'total-cell';
                    const totalValue = grades.total ? toArabicNumerals(grades.total) : '';
                    totalCell.innerHTML = `
                        <input type="number" class="total-display" 
                            value="${totalValue}" placeholder="مج" title="المجموع" readonly>
                    `;
                    row.insertBefore(totalCell, row.querySelector('.average-cell'));
                });
                
                gradesTableBody.appendChild(row);
            });
            
            // إضافة مستمعات الأحداث لحقول الإدخال
            document.querySelectorAll('.grade-input').forEach(input => {
                input.addEventListener('input', function() {
                    calculateStudentTotal(this);
                });
            });
            
            // إضافة مستمعات الأحداث لأزرار التعديل
            document.querySelectorAll('.edit-subject').forEach(btn => {
                btn.addEventListener('click', function() {
                    const subject = this.getAttribute('data-subject');
                    openTeacherView(subject);
                });
            });
            
            // إضافة مستمعات الأحداث لأزرار الحذف
            document.querySelectorAll('.delete-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const student = this.getAttribute('data-student');
                    deleteStudent(student);
                });
            });
        }

        // تحديث جدول التقرير
        function updateReportTable() {
            // مسح الجدول الحالي
            while (reportTableHeader.children.length > 4) {
                reportTableHeader.removeChild(reportTableHeader.lastChild);
            }
            while (reportTableSubHeader.children.length > 4) {
                reportTableSubHeader.removeChild(reportTableSubHeader.lastChild);
            }
            reportTableBody.innerHTML = '';
            
            // إضافة عناوين المواد
            classData.subjects.forEach(subject => {
                // عنوان المادة الرئيسي
                const subjectHeader = document.createElement('th');
                subjectHeader.colSpan = 3;
                subjectHeader.className = 'subject-name-header';
                subjectHeader.textContent = subject;
                reportTableHeader.insertBefore(subjectHeader, reportTableHeader.querySelector('.average-cell'));
                
                // العناوين الفرعية للمادة
                const midtermHeader = document.createElement('th');
                midtermHeader.className = 'symbol-header';
                midtermHeader.textContent = 'ن';
                reportTableSubHeader.insertBefore(midtermHeader, reportTableSubHeader.querySelector('th:nth-child(3)'));
                
                const finalHeader = document.createElement('th');
                finalHeader.className = 'symbol-header';
                finalHeader.textContent = 'م';
                reportTableSubHeader.insertBefore(finalHeader, reportTableSubHeader.querySelector('th:nth-child(3)'));
                
                const totalHeader = document.createElement('th');
                totalHeader.className = 'symbol-header';
                totalHeader.textContent = 'مج';
                reportTableSubHeader.insertBefore(totalHeader, reportTableSubHeader.querySelector('th:nth-child(3)'));
            });
            
            // إضافة صفوف الطلاب
            classData.students.forEach((student, index) => {
                const row = document.createElement('tr');
                row.className = 'grades-table-row';
                
                // حساب المعدل
                let total = 0;
                let subjectCount = 0;
                let average = 0;
                
                classData.subjects.forEach(subject => {
                    if (classData.grades[student]?.[subject]?.total) {
                        total += classData.grades[student][subject].total;
                        subjectCount++;
                    }
                });
                
                if (subjectCount > 0) {
                    average = total / subjectCount;
                }
                
                // حساب التقدير
                const grade = calculateGrade(average);
                
                row.innerHTML = `
                    <td>${toArabicNumerals(index + 1)}</td>
                    <td class="student-name-cell">${student}</td>
                    <!-- سيتم إضافة خلايا المواد ديناميكياً -->
                    <td class="total-cell average-cell">${toArabicNumerals(average.toFixed(2))}</td>
                    <td class="${grade.class}">${grade.text}</td>
                `;
                
                // إضافة خلايا الدرجات لكل مادة
                classData.subjects.forEach(subject => {
                    const grades = classData.grades[student]?.[subject] || {};
                    
                    const midtermCell = document.createElement('td');
                    midtermCell.className = 'midterm-cell';
                    midtermCell.textContent = grades.midterm ? toArabicNumerals(grades.midterm) : '-';
                    row.insertBefore(midtermCell, row.querySelector('.average-cell'));
                    
                    const finalCell = document.createElement('td');
                    finalCell.className = 'final-cell';
                    finalCell.textContent = grades.final ? toArabicNumerals(grades.final) : '-';
                    row.insertBefore(finalCell, row.querySelector('.average-cell'));
                    
                    const totalCell = document.createElement('td');
                    totalCell.className = 'total-cell';
                    totalCell.textContent = grades.total ? toArabicNumerals(grades.total) : '-';
                    row.insertBefore(totalCell, row.querySelector('.average-cell'));
                });
                
                reportTableBody.appendChild(row);
            });
        }

        // حساب مجموع الطالب لمادة معينة
        function calculateStudentTotal(input) {
            const student = input.getAttribute('data-student');
            const subject = input.getAttribute('data-subject');
            const isMidterm = input.classList.contains('midterm');
            
            // الحصول على القيم
            const midtermInput = document.querySelector(`.midterm[data-student="${student}"][data-subject="${subject}"]`);
            const finalInput = document.querySelector(`.final[data-student="${student}"][data-subject="${subject}"]`);
            const totalDisplay = document.querySelector(`.total-display[data-student="${student}"][data-subject="${subject}"]`);
            
            const midterm = midtermInput.value ? parseInt(midtermInput.value) : 0;
            const final = finalInput.value ? parseInt(finalInput.value) : 0;
            const total = midterm + final;
            
            // تحديث العرض
            if (totalDisplay) {
                totalDisplay.value = toArabicNumerals(total);
            }
            
            // تحديث البيانات
            if (!classData.grades[student]) {
                classData.grades[student] = {};
            }
            
            if (!classData.grades[student][subject]) {
                classData.grades[student][subject] = {};
            }
            
            classData.grades[student][subject].midterm = midterm;
            classData.grades[student][subject].final = final;
            classData.grades[student][subject].total = total;
            
            // تحديث المعدل
            updateStudentAverage(student);
        }

        // تحديث معدل الطالب
        function updateStudentAverage(student) {
            let total = 0;
            let subjectCount = 0;
            
            classData.subjects.forEach(subject => {
                if (classData.grades[student]?.[subject]?.total) {
                    total += classData.grades[student][subject].total;
                    subjectCount++;
                }
            });
            
            const average = subjectCount > 0 ? total / subjectCount : 0;
            const averageCell = document.querySelector(`tr:has(td.student-name-cell:contains('${student}')) .average-cell`);
            
            if (averageCell) {
                averageCell.textContent = toArabicNumerals(average.toFixed(2));
            }
        }

        // حساب جميع المعدلات
        function calculateAverages() {
            classData.students.forEach(student => {
                updateStudentAverage(student);
            });
            updateReportTable();
        }

        // حساب التقدير بناءً على المعدل
        function calculateGrade(average) {
            if (average >= 90) return { text: 'ممتاز', class: 'excellent-grade' };
            if (average >= 80) return { text: 'جيد جداً', class: 'very-good-grade' };
            if (average >= 70) return { text: 'جيد', class: 'good-grade' };
            if (average >= 60) return { text: 'مقبول', class: 'pass-grade' };
            return { text: 'ضعيف', class: 'fail-grade' };
        }

        // فتح واجهة المعلم لتعديل مادة معينة
        function openTeacherView(subject) {
            teacherSubject.textContent = `المادة: ${subject}`;
            teacherView.style.display = 'block';
            
            // تمكين حقول الإدخال لهذه المادة فقط
            document.querySelectorAll('.grade-input').forEach(input => {
                input.disabled = input.getAttribute('data-subject') !== subject;
            });
            
            // إضافة مستمعات الأحداث لأزرار الحفظ والإلغاء
            saveGradesBtn.onclick = function() {
                saveGrades(subject);
                teacherView.style.display = 'none';
            };
            
            cancelEditBtn.onclick = function() {
                teacherView.style.display = 'none';
                // إعادة تعطيل الحقول
                document.querySelectorAll('.grade-input').forEach(input => {
                    input.disabled = true;
                });
            };
        }

        // حفظ درجات مادة معينة
        function saveGrades(subject) {
            const inputs = document.querySelectorAll(`.grade-input[data-subject="${subject}"]`);
            
            inputs.forEach(input => {
                calculateStudentTotal(input);
            });
            
            saveData();
        }

        // حفظ جميع الدرجات
        function saveAllGrades() {
            classData.subjects.forEach(subject => {
                const inputs = document.querySelectorAll(`.grade-input[data-subject="${subject}"]`);
                
                inputs.forEach(input => {
                    calculateStudentTotal(input);
                });
            });
            
            saveData();
        }

        // تعبئة الدرجات تلقائياً
        function autoFillGrades() {
            classData.students.forEach(student => {
                classData.subjects.forEach(subject => {
                    if (!classData.grades[student]) {
                        classData.grades[student] = {};
                    }
                    
                    if (!classData.grades[student][subject]) {
                        classData.grades[student][subject] = {};
                    }
                    
                    // تعبئة عشوائية للدرجات (نصفي بين 20-50، نهائي بين 30-50)
                    classData.grades[student][subject].midterm = Math.floor(Math.random() * 30 + 20);
                    classData.grades[student][subject].final = Math.floor(Math.random() * 20 + 30);
                    classData.grades[student][subject].total = 
                        classData.grades[student][subject].midterm + 
                        classData.grades[student][subject].final;
                });
            });
            
            updateGradesTable();
            calculateAverages();
            saveData();
        }

        // حذف طالب
        function deleteStudent(student) {
            if (confirm(`هل أنت متأكد من رغبتك في حذف الطالب ${student}؟`)) {
                const index = classData.students.indexOf(student);
                if (index !== -1) {
                    classData.students.splice(index, 1);
                    delete classData.grades[student];
                    updateStudentCount();
                    updateGradesTable();
                    updateReportTable();
                    saveData();
                    showSuccess('تم حذف الطالب بنجاح');
                }
            }
        }

        // إعادة تعيين الحقول
        function resetFields() {
            if (confirm('هل أنت متأكد من رغبتك في إعادة تعيين جميع الحقول؟')) {
                studentNameInput.value = '';
                subjectNameInput.value = '';
                showSuccess('تم إعادة تعيين الحقول بنجاح');
            }
        }

        // مسح جميع البيانات
        function clearAllData() {
            if (confirm('هل أنت متأكد من رغبتك في مسح جميع البيانات؟ سيتم حذف كل الطلاب والمواد والدرجات.')) {
                classData = {
                    gradeLevel: '',
                    className: '',
                    students: [],
                    subjects: [],
                    grades: {}
                };
                
                gradeLevelSelect.value = '';
                classNameInput.value = '';
                studentNameInput.value = '';
                subjectNameInput.value = '';
                
                updateUI();
                saveData();
                showSuccess('تم مسح جميع البيانات بنجاح');
            }
        }

        // نسخ التقرير إلى الحافظة (الطريقة الجديدة)
        function copyReportToClipboard() {
            let reportText = `كشف درجات الصف ${classData.gradeLevel || '-'} - الفصل ${classData.className || '-'}\n\n`;
            
            // عناوين المواد
            reportText += 'م\tاسم الطالب\t';
            classData.subjects.forEach(subject => {
                reportText += `${subject} (ن)\t${subject} (م)\t${subject} (مج)\t`;
            });
            reportText += 'المعدل\tالتقدير\n';
            
            // بيانات الطلاب
            classData.students.forEach((student, index) => {
                reportText += `${index + 1}\t${student}\t`;
                
                // حساب المعدل
                let total = 0;
                let subjectCount = 0;
                
                classData.subjects.forEach(subject => {
                    const grades = classData.grades[student]?.[subject] || {};
                    reportText += `${grades.midterm || '-'}\t${grades.final || '-'}\t${grades.total || '-'}\t`;
                    
                    if (grades.total) {
                        total += grades.total;
                        subjectCount++;
                    }
                });
                
                const average = subjectCount > 0 ? total / subjectCount : 0;
                const grade = calculateGrade(average);
                
                reportText += `${average.toFixed(2)}\t${grade.text}\n`;
            });
            
            // استخدام الطريقة البديلة للنسخ
            fallbackCopyTextToClipboard(reportText);
        }
        
        // الطريقة البديلة للنسخ إلى الحافظة
        function fallbackCopyTextToClipboard(text) {
            // إنشاء عنصر نصي مؤقت
            const textArea = document.createElement('textarea');
            textArea.value = text;
            textArea.style.position = 'fixed';
            textArea.style.top = '0';
            textArea.style.left = '0';
            textArea.style.opacity = '0';
            
            document.body.appendChild(textArea);
            textArea.focus();
            textArea.select();
            
            try {
                // محاولة النسخ باستخدام الأمر القديم
                const successful = document.execCommand('copy');
                if (successful) {
                    showSuccess('تم نسخ كشف الدرجات إلى الحافظة بنجاح');
                } else {
                    showError('فشل نسخ كشف الدرجات: الرجاء النسخ يدويًا');
                }
            } catch (err) {
                showError('حدث خطأ أثناء النسخ: ' + err);
            }
            
            // إزالة العنصر المؤقت
            document.body.removeChild(textArea);
        }

        // تصدير البيانات إلى Excel
        function exportToExcel() {
            // إنشاء مصنف Excel
            const wb = XLSX.utils.book_new();
            
            // إنشاء ورقة للبيانات
            const data = [];
            
            // إضافة العنوان
            data.push(['كشف درجات الصف', classData.gradeLevel || '-', 'الفصل', classData.className || '-']);
            data.push([]);
            
            // عناوين الأعمدة
            const headers = ['م', 'اسم الطالب'];
            classData.subjects.forEach(subject => {
                headers.push(`${subject} (ن)`);
                headers.push(`${subject} (م)`);
                headers.push(`${subject} (مج)`);
            });
            headers.push('المعدل', 'التقدير');
            data.push(headers);
            
            // بيانات الطلاب
            classData.students.forEach((student, index) => {
                const row = [index + 1, student];
                
                // حساب المعدل
                let total = 0;
                let subjectCount = 0;
                
                classData.subjects.forEach(subject => {
                    const grades = classData.grades[student]?.[subject] || {};
                    row.push(grades.midterm || '-');
                    row.push(grades.final || '-');
                    row.push(grades.total || '-');
                    
                    if (grades.total) {
                        total += grades.total;
                        subjectCount++;
                    }
                });
                
                const average = subjectCount > 0 ? total / subjectCount : 0;
                const grade = calculateGrade(average);
                
                row.push(average.toFixed(2));
                row.push(grade.text);
                
                data.push(row);
            });
            
            // تحويل البيانات إلى ورقة عمل
            const ws = XLSX.utils.aoa_to_sheet(data);
            
            // إضافة الورقة إلى المصنف
            XLSX.utils.book_append_sheet(wb, ws, 'كشف الدرجات');
            
            // إنشاء اسم الملف باستخدام الأرقام الهندية
            const fileName = `كشف_درجات_${classData.gradeLevel || 'صف'}_${classData.className || 'فصل'}.xlsx`;
            
            // تصدير الملف
            XLSX.writeFile(wb, fileName);
            
            showSuccess('تم تصدير كشف الدرجات إلى ملف Excel بنجاح');
        }

        // تحديث واجهة المستخدم
        function updateUI() {
            currentGradeSpan.textContent = classData.gradeLevel || '-';
            reportGradeSpan.textContent = classData.gradeLevel || '-';
            currentClassSpan.textContent = classData.className || '-';
            reportClassSpan.textContent = classData.className || '-';
            
            if (classData.gradeLevel) {
                gradeLevelSelect.value = classData.gradeLevel;
            }
            
            if (classData.className) {
                classNameInput.value = classData.className;
            }
            
            updateStudentCount();
            updateSubjectCount();
            updateGradesTable();
            updateReportTable();
        }

        // تحديث عداد الطلاب
        function updateStudentCount() {
            studentCountSpan.textContent = toArabicNumerals(classData.students.length);
            reportStudentCountSpan.textContent = toArabicNumerals(classData.students.length);
        }

        // تحديث عداد المواد
        function updateSubjectCount() {
            subjectCountSpan.textContent = toArabicNumerals(classData.subjects.length);
            reportSubjectCountSpan.textContent = toArabicNumerals(classData.subjects.length);
        }

        // حفظ البيانات في localStorage
        function saveData() {
            localStorage.setItem('classData', JSON.stringify(classData));
        }

        // تحميل البيانات من localStorage
        function loadData() {
            const savedData = localStorage.getItem('classData');
            if (savedData) {
                classData = JSON.parse(savedData);
            }
        }

        // عرض رسالة خطأ
        function showError(message) {
            errorAlert.textContent = convertNumbersInString(message);
            errorAlert.style.display = 'block';
            setTimeout(() => {
                errorAlert.style.display = 'none';
            }, 5000);
        }

        // عرض رسالة نجاح
        function showSuccess(message) {
            successAlert.textContent = convertNumbersInString(message);
            successAlert.style.display = 'block';
            setTimeout(() => {
                successAlert.style.display = 'none';
            }, 3000);
        }
    </script>
</body>
</html>